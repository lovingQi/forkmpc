状态变量为[x, y, φ]  控制变量为[v, δ]  车辆轴距为L
1. 非线性状态方程
ẋ = v * cos(φ)
ẏ = v * sin(φ)
φ̇ = v * tan(δ)/L

2. 在参考点处的泰勒展开

ẋ - ẋᵣ = A(x-xᵣ) + B(u-uᵣ)

3.计算雅可比矩阵

A，B

4.定义偏差变量
Δx = x - xᵣ   (状态偏差)
Δu = u - uᵣ   (控制偏差)
Δẋ = ẋ - ẋᵣ   (状态导数偏差)

5、离散化（使用前向欧拉法）

Δx(k+1) = Δx(k) + dt*Δẋ(k)

计算得到：
Δx(k+1) = Δx(k) + dt*(A*Δx(k) + B*Δu(k))
        = (I + dt*A)*Δx(k) + dt*B*Δu(k) 

6、开始预测滚动优化计算

7、目标函数设计

## 7.1 基本目标函数
原始目标函数形式：
J(k) = Σ x̃ᵀ(k+j|k)Qx̃(k+j) + ũᵀ(k+j-1)Rũ(k+j-1)

## 7.2 控制约束
控制量约束：
uₘᵢₙ(t+k) ≤ u(t+k) ≤ uₘₐₓ(t+k), k = 0,1,...,Nc-1

控制增量约束：
Δuₘᵢₙ(t+k) ≤ Δu(t+k) ≤ Δuₘₐₓ(t+k), k = 0,1,...,Nc-1

其中：
u(t+k) = u(t+k-1) + Δu(t+k)

## 7.3 约束矩阵构建
定义：
U₁ = 1ₙ ⊗ u(t-1)

其中：
- 1ₙ为Nc维列向量
- ⊗表示Kronecker积
- u(t-1)为上一时刻的控制量

构建约束矩阵A：
A = [1  0  ...  0]
    [1  1  ...  0]
    [1  1  1  0]
    [...    ...  ]
    [1  1  ...  1] ⊗ Iₘ

其中Iₘ为控制量维度的单位矩阵

## 7.4 完整的约束形式
将约束改写为标准形式：
Uₘᵢₙ ≤ A·ΔU + U₁ ≤ Uₘₐₓ

## 7.5 扩展目标函数
考虑控制增量和松弛因子的完整目标函数：
J(ξ(t),u(t-1),ΔU(t)) = [ΔU(t)ᵀ,ε]·H₁·[ΔU(t)ᵀ,ε]ᵀ + G₁·[ΔU(t)ᵀ,ε]ᵀ

其中：
- H₁ = [Θᵀ·Q·Θ + R  0]
       [0             ρ]
- G₁ = [2εᵀ·Q·Θ  0]
- ε为松弛因子
- ρ为松弛因子权重

## 7.6 约束条件
s.t.  ΔUₘᵢₙ ≤ ΔU ≤ ΔUₘₐₓ
      Uₘᵢₙ ≤ A·ΔU + U₁ ≤ Uₘₐₓ

8、预测状态空间模型
定义增广状态向量：
ξ(k|t) = [x̃(k|t)ᵀ, ũ(k-1|t)ᵀ]ᵀ

得到新的状态空间方程：
ξ(k+1|t) = Ã_k,t*ξ(k|t) + B̃_k,t*ΔU(k|t)
η(k|t) = C̃_k,t*ξ(k|t)

其中：
Ã_k,t = [Ad_k,t  Bd_k,t]
        [0       I    ]

B̃_k,t = [Bd_k,t]
        [I    ]

9、预测输出
系统的预测输出可以表示为：
Y(t) = Ψ*ξ(t|t) + Θ*ΔU(t)

其中：
Y(t) = [η(t+1|t), η(t+2|t), ..., η(t+Np|t)]ᵀ

Ψ = [C̃_k,tÃ_k,t]
    [C̃_k,tÃ²_k,t]
    [...]
    [C̃_k,tÃᴺᵖ_k,t]

Θ = [C̃_k,tB̃_k,t    0         0       ...  0    ]
    [C̃_k,tÃ_k,tB̃_k,t  C̃_k,tB̃_k,t  0       ...  0    ]
    [...]
    [C̃_k,tÃᴺᵖ⁻¹_k,tB̃_k,t  ...  C̃_k,tÃᴺᵖ⁻ᴺᶜ_k,tB̃_k,t]

ΔU(t) = [Δu(t|t), Δu(t+1|t), ..., Δu(t+Nc-1|t)]ᵀ

10、最终二次规划问题
将预测输出代入目标函数，可得到标准二次规划形式：


min  1/2*ΔUᵀ*H*ΔU + fᵀ*ΔU
s.t. lb ≤ ΔU ≤ ub
     Ax*ΔU ≤ b
